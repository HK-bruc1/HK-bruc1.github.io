# name: 部署到 Github Pages

# on:
  # push:  # 当有推送操作时触发
    # branches: [main]  # 只在 master 分支上触发
  # pull_request:  # 当有拉取请求操作时触发
    # branches: [main]  # 只在 master 分支上触发

# jobs:
  # build:  # 构建任务
    # runs-on: ubuntu-latest  # 在最新版的 Ubuntu 上运行

    # permissions:
      # # 给默认的 GITHUB_TOKEN 写权限，以便提交和推送添加或更改的文件到仓库。
      # contents: write

    # steps:
      # - name: Checkout
        # uses: actions/checkout@v4.1.1 # 检出代码
        
      # - name: Cache Hugo resources  # 缓存 Hugo 资源
        # uses: actions/cache@v4.0.0
        # env:
          # cache-name: cache-hugo-resources
        # with:
          # path: resources  # 缓存路径
          # key: ${{ env.cache-name }}  # 缓存的键值

      # - uses: actions/setup-go@v5.0.0  # 设置 Go 环境
        # with:
          # go-version: "^1.21.6"  # 使用 Go 1.17.0 版本
      # - run: go version  # 显示 Go 版本以验证安装

      # - name: Setup Hugo  # 配置 Hugo
        # uses: peaceiris/actions-hugo@v2.6.0
        # with:
          # hugo-version: "0.122.0"  # 使用最新版的 Hugo
          # extended: true  # 使用扩展版 Hugo

      # - name: Build  # 构建
        # run: hugo --minify --gc  # 执行 Hugo 构建命令，启用压缩和垃圾收集

      # - name: Deploy 🚀  # 部署
        # uses: JamesIves/github-pages-deploy-action@v4.5.0
        # with:
          # branch: gh-pages  # 部署到 gh-pages 分支
          # folder: public  # 指定部署的目录
          # clean: true  # 清理部署分支，只保留最新的提交
          # single-commit: true  # 部署时只创建一个提交
          
          
          
name: Deploy to Github Pages

on:
    push:
        branches: [master]
    pull_request:
        branches: [master]

jobs:
    build:
        runs-on: ubuntu-latest

        permissions:
            # Give the default GITHUB_TOKEN write permission to commit and push the
            # added or changed files to the repository.
            contents: write

        steps:
            - uses: actions/checkout@v3

            - name: Cache Hugo resources
              uses: actions/cache@v3
              env:
                  cache-name: cache-hugo-resources
              with:
                  path: resources
                  key: ${{ env.cache-name }}

            - uses: actions/setup-go@v4
              with:
                  go-version: "^1.17.0"
            - run: go version

            - name: Setup Hugo
              uses: peaceiris/actions-hugo@v2
              with:
                  hugo-version: "latest"
                  extended: true

            - name: Build
              run: hugo --minify --gc

            - name: Deploy 🚀
              uses: JamesIves/github-pages-deploy-action@v4
              with:
                  branch: gh-pages
                  folder: public
                  clean: true
                  single-commit: true