name: éƒ¨ç½²åˆ° Github Pages

on:
  push:  # å½“æœ‰æ¨é€æ“ä½œæ—¶è§¦å‘
    branches: [main]  # åªåœ¨ master åˆ†æ”¯ä¸Šè§¦å‘
  pull_request:  # å½“æœ‰æ‹‰å–è¯·æ±‚æ“ä½œæ—¶è§¦å‘
    branches: [main]  # åªåœ¨ master åˆ†æ”¯ä¸Šè§¦å‘

jobs:
  build:  # æ„å»ºä»»åŠ¡
    runs-on: ubuntu-latest  # åœ¨æœ€æ–°ç‰ˆçš„ Ubuntu ä¸Šè¿è¡Œ

    permissions:
      # ç»™é»˜è®¤çš„ GITHUB_TOKEN å†™æƒé™ï¼Œä»¥ä¾¿æäº¤å’Œæ¨é€æ·»åŠ æˆ–æ›´æ”¹çš„æ–‡ä»¶åˆ°ä»“åº“ã€‚
      contents: write

    steps:
      - uses: actions/checkout@v3  # æ£€å‡ºä»£ç 

      - name: Cache Hugo resources  # ç¼“å­˜ Hugo èµ„æº
        uses: actions/cache@v3
        env:
          cache-name: cache-hugo-resources
        with:
          path: resources  # ç¼“å­˜è·¯å¾„
          key: ${{ env.cache-name }}  # ç¼“å­˜çš„é”®å€¼

      - uses: actions/setup-go@v4  # è®¾ç½® Go ç¯å¢ƒ
        with:
          go-version: "^1.17.0"  # ä½¿ç”¨ Go 1.17.0 ç‰ˆæœ¬
      - run: go version  # æ˜¾ç¤º Go ç‰ˆæœ¬ä»¥éªŒè¯å®‰è£…

      - name: Setup Hugo  # é…ç½® Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: "latest"  # ä½¿ç”¨æœ€æ–°ç‰ˆçš„ Hugo
          extended: true  # ä½¿ç”¨æ‰©å±•ç‰ˆ Hugo

      - name: Build  # æ„å»º
        run: hugo --minify --gc  # æ‰§è¡Œ Hugo æ„å»ºå‘½ä»¤ï¼Œå¯ç”¨å‹ç¼©å’Œåƒåœ¾æ”¶é›†

      - name: Deploy ğŸš€  # éƒ¨ç½²
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages  # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
          folder: public  # æŒ‡å®šéƒ¨ç½²çš„ç›®å½•
          clean: true  # æ¸…ç†éƒ¨ç½²åˆ†æ”¯ï¼Œåªä¿ç•™æœ€æ–°çš„æäº¤
          single-commit: true  # éƒ¨ç½²æ—¶åªåˆ›å»ºä¸€ä¸ªæäº¤
